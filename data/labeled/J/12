"I love writing authentication and authorization code." ~ No Developer Ever. Try Okta instead.. Who isn't getting into Bitcoin these days? In the past year, the value of Bitcoin alone is creating huge FOMO, and driving increasing investments into cryptocurrencies. With this massive influx of new cash in cryptocurrencies like Bitcoin, Ethereum, Monero, and Ripple -- blockchain technology (which is the foundation of all cryptocurrency) has become an area of intense technical study. At its core, blockchain technology simply maintains a decentralized log of transactions that can be easily shared across many nodes (miners).. In this post, I'll show you how to add authentication to an Ionic progressive web app (PWA). PWAs are more developer-friendly to distribute than mobile apps. Not only that, but I'll show you how to use cloud services like Okta and Firebase to make things even simpler.. Josh Morony is someone I've followed ever since I got into Ionic. After developing my first app using Ionic, I bought and read his book on Building Mobile Apps with Ionic. He's a good marketer, and I've been receiving his newsletter ever since. As a developer, I get a lot of emails, and I usually delete the newsletter emails because most don't provide value. I've never deleted Josh's, and I started receiving it years ago. He does a great job of providing valuable information to developers!. About a month ago, I received an email from Josh advertising his Crypto PWA series of articles, which were excellent (as I expected). I highly recommend you check out Part 1: Building a Cryptocurrency Price Tracker PWA in Ionic.. You can also see his finished app at https://cryptopwa.com and find it on GitHub. I thought it'd be fun to add authentication to Josh's app and show you how I did it. It wasn't too hard thanks to the fact that Ionic uses Angular and it has excellent OIDC support -- thanks to Manfred Steyer's awesome angular-oauth2-oidc library.. Set Up the Crypto PWA. To begin, clone Josh's finished repository.. git clone https://github.com/joshuamorony/ionic-crypto-pwa.git cd ionic-crypto-pwa npm install. Install Ionic so you'll be able to run the app.. npm install -g ionic. Run the app so you can see its basic functionality before adding authentication.. You can verify it works offline -- like a PWA should -- by toggling offline mode in your browser (in Chrome: Developer Tools > Network > Offline).. NOTE: This application is designed specifically to be a PWA, not for packaging as a native app and deploying to a phone. For this reason, I don't account for developing and deploying it as a mobile app in this post. If you're interested in that, please see the other articles at the end of this post.. Add Okta for Authentication. Happily, the hardest part of using Okta is creating a developer account, so you'll need to start there. Within 2-3 minutes, you should be able to log in to our developer console and create new applications. Follow the steps below to create an OpenID Connect (OIDC) application that allows you to authenticate with your Okta accounts.. Log in to your Okta account and navigate to Applications > Add Application Select SPA and click Next Give your application a name (e.g. "Crypto PWA") Add the following values for Base URI and Login redirect URI: http://localhost:8100 (for development) https://<name-of-your-choosing>.firebaseapp.com (for production) Click Done to continue. You should see settings like the following:. For global logout to work, you'll need to edit your application and add http://localhost:8080 (and optionally, your production URI) as a Logout redirect URI.. Add Angular OIDC Support. At this point, I tried adding Okta's Angular SDK using npm install --save @okta/okta-angular. However, I quickly discovered this library doesn't work with Ionic because it has a dependency on Angular Router, which Ionic doesn't use. You can track this issue on GitHub.. I knew that angular-oauth2-oidc worked based on a previous tutorial, so I installed angular-oauth2-oidc. Please do the same if you're following along.. npm install --save angular-oauth2-oidc. In src/app/app.module.ts, import OAuthModule.. import { OAuthModule } from 'angular-oauth2-oidc'; @NgModule({ ... imports: [ ... OAuthModule.forRoot() ], ... }). Create a Login Page. Generate a login page by running the following command:. ionic g page Login. Modify src/app/app.component.ts to use oauthService to check for a valid ID token and choose the appropriate page to display.. import { Component } from '@angular/core'; import { OAuthService } from 'angular-oauth2-oidc'; @Component({ templateUrl: 'app.html' }) export class MyApp { rootPage: any = 'HomePage'; constructor(oauthService: OAuthService) { if (oauthService.hasValidIdToken()) { this.rootPage = 'HomePage'; } else { this.rootPage = 'LoginPage'; } } }. In src/pages/login/login.ts, add your OIDC application settings in the constructor and add a login() method.. import { Component } from '@angular/core'; import { IonicPage, App } from 'ionic-angular'; import { JwksValidationHandler, OAuthService } from 'angular-oauth2-oidc'; @IonicPage({ name: 'LoginPage' }) @Component({ selector: 'page-login', templateUrl: 'login.html' }) export class LoginPage { constructor(private oauthService: OAuthService, private app: App) { if (this.oauthService.hasValidIdToken()) { this.app.getRootNavs()[0].setRoot('HomePage'); } oauthService.redirectUri = window.location.origin; oauthService.clientId = '{clientId}'; oauthService.scope = 'openid profile email'; oauthService.issuer = 'https://{yourOktaDomain}.com/oauth2/default'; oauthService.tokenValidationHandler = new JwksValidationHandler(); oauthService.loadDiscoveryDocumentAndTryLogin(); } login() { this.oauthService.initImplicitFlow(); } }. Populate src/pages/login/login.html with the following HTML that welcomes the user and provides a login button.. <ion-header> <ion-navbar> <ion-title> Login </ion-title> </ion-navbar> </ion-header> <ion-content padding> <div class="message"> <p><strong>cryptoPWA</strong> is a <strong>P</strong>rogressive <strong>W</strong>eb <strong>A</strong>pplication that allows you to keep track of the approximate worth of your cryptocurrency portfolio.</p> <p>A PWA is like a typical application from the app store, but you can access it directly through the web. You may also add this page to your home screen to launch it like your other applications.</p> <p>Log in to start tracking your coins in whatever currency you wish!</p> </div> <button ion-button (click)="login()" color="primary"> Login with Okta </button> </ion-content>. In src/pages/home/home.html, add padding to the ion-content tag, change the <div class="message"> to welcome the user by name, and modify the welcome message. This change is necessary because the original message says no account is required.. <ion-content padding> <h1>Welcome, {{ name }}</h1> <div class="message" *ngIf="!holdingsProvider.holdings.length"> <p><strong>cryptoPWA</strong> is a <strong>P</strong>rogressive <strong>W</strong>eb <strong>A</strong>pplication that allows you to keep track of the approximate worth of your cryptocurrency portfolio.</p> <p>Click the button below to start tracking your coins in whatever currency you wish!</p> <button ion-button full (click)="addHolding()" color="primary">Add Coins</button> </div> ... </ion-content>. Change src/pages/home/home.ts to check for a valid access token, and to have a getter for the name referenced in the template above.. import { OAuthService } from 'angular-oauth2-oidc'; ... export class HomePage { constructor(private navCtrl: NavController, private holdingsProvider: HoldingsProvider, private oauthService: OAuthService) { } ionViewDidLoad(): void { if (!this.oauthService.hasValidAccessToken()) { this.navCtrl.push('LoginPage'); } this.holdingsProvider.loadHoldings(); } ... get name() { const claims: any = this.oauthService.getIdentityClaims(); if (!claims) { return null; } return claims.name; } }. Restart ionic serve, and you should see the login page at http://localhost:8100.. Click Login with Okta and you'll be redirected to a login form.. TIP: Did you know you don't need to include @<your-email>.com for the username with Okta? Entering the first part of your email address is enough for Okta to know who you are.. After entering valid credentials, you should be redirected back to your app and see a welcome message.. You should be able to add cryptocurrency holdings as you did before. The last thing you'll want to do is add a logout button.. Add a Logout Button. To add a logout button, add a logout() method to src/pages/home/home.ts.. logout() { this.oauthService.logOut(); }. Then add a logout button just above </ion-content> in src/pages/home/home.html.. <button ion-button (click)="logout()">Logout</button>. Your home page should now look as follows.. Deploy to Firebase and Test With Lighthouse. If you'd like to deploy your app to Firebase, log in to your account, go to the console, and create a new project. On the project overview screen, scroll to Hosting card, and click Get Started. Once you've completed the steps, you should be able to run the following commands to deploy your app.. npm run ionic:build --prod firebase deploy. I deployed mine to https://cryptopwa-oidc.firebaseapp.com and received a Lighthouse score of 91. Lighthouse is an automated tool for auditing the quality of web pages. You can run it against any web page to see audits for performance, accessibility, progressive web apps, and more.. I compared this with the original tutorial's production instance at https://cryptopwa.com and found it received the same score.. I scrolled down my report to see why I didn't receive a perfect 100. I had two failed audits:. Does not provide fallback content when JavaScript is not available Has a <meta name="viewport"> tag with width or initial-scale (Invalid properties found: "{viewport-fit":"cover"}). To fix the first issue, add the following HTML in src/index.html, just after the <body> tag.. <noscript> <h1>You must enable JavaScript to view this page.</h1> </noscript>. To fix the second issue, remove viewport-fit=cover, from the <meta name="viewport"> tag's content attribute.. <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">. Redeploy using the commands below:. npm run ionic:build --prod firebase deploy. Rerunning Lighthouse should give you a perfect PWA score of 100. Huzzah!. Learn More About Ionic and PWAs. In a future tutorial, I'll show you how to replace this app's local storage implementation with Okta's custom profile attributes. This enhancement will allow you to track your cryptocurrency holdings from any device, with any browser!. For now, I hope you've enjoyed this brief look at Ionic, PWAs, and Okta. PWAs are more straightforward to distribute than mobile apps, and cloud services like Okta and Firebase make things even simpler.. You can see the complete source code for this project on GitHub. Please contact me on Twitter @mraible, via Okta's Developer Forums, or in the comments below if you have any questions.. To learn more about Ionic and PWAs, check out the following resources:. Tutorial: Develop a Mobile App With Ionic and Spring Boot Build an Ionic App with User Authentication The Ultimate Guide to Progressive Web Applications. Protect Your Cryptocurrency Wealth Tracking PWA with Okta was originally published on the Okta developer blog on January 18, 2018.. 
`_ `___ `______ `_____________ `__ `____________ `_____ ` `_ `________ `____ `__ `___ `________ `__ `____ `______ `___ 1______ `____ `____ `_ `__ `___ `____ `__ `____ `_ 1______ `____ `_ `_______ `___ `____ `__ `______ `_________ `__________ `___ `________________ `___ `___ `______ `_____ `_ `__ `___ `_ `_______________ `___ 1_______ 1________ 1______ `__ 1_____ `_ `_________ `_________ `_____ `_ `__ `_________ `_ `__ `______________ `__ `_____ `_ `___ `_ `______ `________ `_____ `_ `__ `____ `_________ `_________ `_____ `________ ` `____________ `__ `_ `___________ `___ `__ `_ `_____ `_____ `_____ `___ `____ `_________ `_ `___ `____ `___ `___ `__ `__ `_ `__ `_____________ `_ `_ `____ `__________ `__ `__ `_____ `___ `__ `___ `_________________ `_ `_________ `___ `_____ `____ `__ `___ `____ `__ `___ `___ `__ `__ `_ `__ `____ `_______ `___ `___ `__ `_______ `_ `___ `_____ `___ `________ `___ `_____ `_ `______ `___ `_______ `___ `____ ` `__ `___ `_____ `____ `_________ `_ `____ `__ `____ `_____ ` `_____ `__ `___ `__ `___ `_ `_______ `_____ `___ `___ `_____ `___ ` `___ `________ `__ `___ `___ `________ `__ `_________ `___ `_____ `_ ` `_________ ` `__ ` `__ `_ `______ `__ ` `______ `_____ `__ `_________ `_____ `______ `___ `____ `______ `_____ `___ `____ `______ `______ `__ ` `______ `________ `_ `____ `___ `_ `___ ` `____ `__ `_ `________ `_______ `__________ `_ `___________ `____ ` `____ `___ ` `_______ `_ `____ `___ `___ `__________ `__ `_____ `__ `_____ `_ `________ `____ `___ `________ `__ ` `_________ ` `_____ `________ `__ `____ `__ `___ `_ `_______ ` `_____________ `____ `______ `__ `_ `______ `__ `__ `___ `__ `__ `_______ `__ `_ `____________________ `__ `___ `_ `_ `______ ` `______ `___ `_ `__ `_ `__ `_____________ `_ `_____ `__ `__ `___ `__ `__ ` `__ `__ `_ `_____ `__ `___ `_____ `_ `__ `___ `___ `____ `___ `______ `__ `_ `__ `________ `___ `______ `_ `_____ `_ `______ `_______ `______ `__________________ `________ `__ `_ `__ `_____ `___ `_ `_____ `____ `_____ `_______ `___________ `__ `____ `___________________________________________________ `_ `_______________ `__ `_______ `______ `____ `_ `_____ `_ `___ `_ `__ `__ `____ `__ `______ `_ `_____ `__ `__ `__ `_ `__ `__ `__ `__ `____ `____________ `_____ `_____ `_______________ `__ `__ `_____ `_ `____ `______ `_ `___ ` `__ `_____ `_ `_ `_______ `______ `___ `_ `___ `______ `__ `______ `________ `____ ` `______ ` `_________ `____ `___ `__________ `_ `_______ `___________ `_ `_ ` `___ `__ `__ `________ `_ ` `_____ `__ `__ `________ `_ ` `_____ `__ `___ `______ ` `____ `______ `__ `_________ `__ `________ `_ `_ ` `_____ `__ `_ `___ `____ `_ `_____ `_________ `_ `____ `_____ `__ `__ `____ `_______ `_ `__ `__ `_ `___ `_____ `__ `___ `__ `______________ `_______ `__ `______ `___ `_ `____ `___ `_ `_______ ` `________ `_______ `_ `_____ `___ `_ `____ `_____ `_____ `__ `_______ `__ `_____ `_ `___ `_ `__ `_ `_ `__ `________ `______ `__ `_____ `__ `____________ `_____ `__ `____ `____ `_ `_____ `_ `_____ `______ `_____ `__________ `___ `_____ `__ `_ `___________ `___ `___ `___ `_________ `__ `_ `_ `___ `___ `______ `__ `_______ `_ `___________ ` `__ `__________ `_____ `__ `__ `____ `___ `___ `___ `__________ ` `___ `____ `______ `____ `__ `__ `________ `_____ `__ `___ `__ `__ `____ `_______ `___ `____________________ `___ `___________ `______________________________________________ `___ `__________ `____ `___ `_ `________ `__ `_____ `__ `_______ `___ `__ `__________ `__ `_____ `_____ `_ `____ `_____ `___ `_ `___ `___ `__________ `__ `__ `____________________ `___ `__________ `___ `_________ `___ `_ ` `_____ `_______ `____ `__ `______ `___ `_______ `_ `___ `_____ ` `____ `_____ `_____ `______ `__ `____ `__ `______ `_____ `__________________ `_______ ` `______ `_________ `___ `______ `______ `___ `___ `____ `______ `_ `__ ` `_________ `_ `______ `______ `____ `____ `______ `___ `__ `__ `____ `___ `____ `_ `_______ ` `___ `___ `__________________ `_____ `____ `_ ` `_______ `________ `_ ` `________ `___________________ `_____ `_ `__ `___ `_ `_____ `________ `______ `__ `______ `_____ `___________________ `_ `_____________________ `_____ `____________ `_____ ` `__________ ` `___ `_____________________ `__________ `__ `_______ ` `__ `____________________ `_ `__ `__ `_____ ` `____ `____ `_______ ` `____ `___ `_ `______ `__ `________ `________ `____ ` `___ `_____ `_____ `_______________________ `_ `__ `___________ `_ `____ `__ ` `____ `_ `____ `__ `_____ `__ `__________ `___ `_ `________ `_____ ` `________ ` `___ `_______________ `_____ ` `___________ ` `___ `_____________________ `___________ `___________ `_________ `_ `_____ `____ `____ ` `________ `__ ` `__________ `________________________ `____________ ` `_ `_______________________________ ` `____________ ` `__________ ` `___ ` `____________ ` `___________ ` ` `_ `_ `________________________ `__ `___ `___ `__________ `_______ `_ `__ `__________ `__ `__ ` `______ `_______ `_____ ` `________ ` `___ `_______________ `_____ ` `_________ `__ ` `___ `_______________ `_____ ` `_____________________ `___________ ` `___ `_____________________ `___________ `____ `__________ `_ `___________ `________ `____________ `___________ `___________ `_ `_____ `____ `________ ` `__________________ `____________ `____________ `______ `___ `___ ` `_ `____________________________________ ` `_____________________________________________ ` `_______________________ ` `______________________ `____________________ ` `____________ `_________________ ` `______ `______ `______ `__________________ ` `_____________________________________________ `__________________________________ ` `__ `_______________________ `_______________________________________________ ` `______ ` `____________________________________ ` `_ `_______ `_________________________ `___ `__ `________ `___ `___ `_______ `__ `___ `__ `_______ ` `____ `_______ `___________ `___________ `__________ `____ `___________ `____________ `____________ `___________ `_______ `___ `_______________ `____________________________ `_ ` `___________________________ `___________________ `___________________________ `___ `_____ `__ `_ `___ `____ `_ `__ `__________ `____ `_ `___ `_____________ `_____________ `___ `__ `_ `___ ` `______ `__________ `___ `__ `__ `_____ `__ `__ `__ `_____ `_ `_______ `______ `__ `___ `__ `__ `___ `__ `___ `___ `_ `___ `___ `_____ `_ `_____ `_ `___ `___ `____ `________________ `_____ `_ `_ `____ `_______ `___ `____ `_ `_______ `_______ `__ `________ `_____ `______ `_________ `________________ `_______________ `____ `___ `___ `________ `______________ `_ `________________________ `__ `______ `_ `__ `__________ `___ `_____ `__ `___ `_______________ `_ `______ `__ `___ `_ `____ `__ `_____ `__ `______ `_______ `___ `_____ `_ `________ `______ `__ `_______ `______ `___ `_ `______ `_ `_________ `___________ `_______ `___________ `_ `___ `______ `___ `______________ `_________________________________________ `____________________________ `_ ` `___________________________ `___________________ `___________________________ `___ `_____ `__ `_ `___ `____ `_ `__ `__________ `____ `_ `___ `_____________ `_____________ `_______ `__ `_____ `____ `_ `____ `_______ `___ `____ `_ `_______ `_______ `__ `________ `______ `_________ `___ `_____________________ `__________________ `_____________ `_____ `__ `______________ `_____ `_____________________ `_ `____ `__ ` `____ `_____ `_____ `__ `_ `___ ` `_____ `__ `__ `___ `_________ `_ `__ `_______ `______ `_____ ` `___________ ` `___ `_____________________ `__ `_____ `____ `_______ ` `__________________ `_______ `_____________ `______ `________________ `________________ `______ `____________ `____________ ` ` `________________ `___ ` `_ `_________________________________________ ` `______________________________ ` `____________________________________ ` `__ `__ `_____ ` `____ `______ `__ ` `_____________________________________ `_ `________ ` `_____ `____ ` `_____ `___________ ` `_ `______ `____ `_____ `__ `__ `_____ `__ `__ `____ `___ `_ `______________________ `____ `____ `___ `___ `__ `_____ `_ `_________ `_ ` `____ `_____ `___ `__ `__ `___ `__ `____ `___ `_ `______ `________________ `__ `__ `_______ `___ `____ `_______ `__ `____ `___ `_ `___ `____ `______ `_ `_____ `__ `___ `_ `___ `__ `__ `____ `____ `_______ `____ `___________ `__ `_____ `_ `_________ `___ `_ `___ `__ `__ `__ ` `______ `________ `__ `_____ `_ `___ `_ `__ `_____________ `_______ `_ `__ `__ `______ `__ `___ `____ `_____ `___ `_ `_ `_ `__ ` `_____ `_______ `__ ` `_____ `______ `_ `__ ` `_____ `______ `__ ` `_______ `_____ `_ `_______________________ `_______ ` `__________________________ `_ `___ `__ ` `_____ `_____ `___ `____ `_____________ `_ `_________________________ `______ `_________ `__________________________________ `___ `___ `___ `_____ `__ `___ `_ `________ `_____ `_ `_______ `__ `___ `___ `__________ `_ `____ `___ `_ `_____ `___ `__ `_ `________ `__ `_ `_ `___ `_______ `_ `_ `__ `_______ `__ `_____ ` `__ `_______ `_ `__ `______ `_______ `______ `_____ `_ `______ `____ `__ `____ `__ `_______ `___ `_____ `________ `__ `_____ `__ `_____ `_ `___ `_ `__ `__ `________ `_______ `_ `_____ `___ `____ `__ `__ `__________ `_____ `_______ `______ ` `_______ `___ `_ `_____________________________________ `__ `_______ ` `_________ `____ `_ `__ `_________ `_ `_ `________ `___ `__ `_______ `__ `______ `_ `__ `_____ `__ `__ `__ `_ `______ `__ `__ `___ `_ `__ `_____ `__ `___________ `_____________ `__________ `__ `____ `__ `_____ ` `_______ `___ `___ `__ `_______ `_________ `_________ `_______ `_ `____________________ `__ `____ `_ `_______ `__ `___ `______ ` `_______ `___ `_ `_____ `_ `__ `__ ` `_____ `______ ` `______ `___ ` `__ `__ `_____ `_______ `___ `__ `______ `_______ `______ `___ `_________ `_ `__ `________ `__ ` `____ `_______________ `__ `___ `____ `_ `____________ `_______ `_________ `_____ `_________________________ `_ `__ `__ `____ `_____ `__ `__ `________ `___ `_ `______________ `___ `____ `__ `_____ `____ `_________ `______ `___ `_____ `_________ `_ `___ `___ `_________ `___________ `_ `__ `__ `_____ `_____ `_____ `__________________ `___ `__ `____ `_______________ `____ `______ `__________ `____ `______________ `___________________________ `_________________ `_________________ `_________________ `__________________ `_______ `____ `__ `_______ `______ `__ `__ `__________ `_____ `_______ `______ `________ `_________ `_____ `___ `__ ` `______ `__ `____ `_ `___ `_______ `____ `___ `____ `____ `__ `____ `_ ` `_____ `________ `___ `___ `__ `__ `_ `______ `___ `____ `____ `______ `_____________ `___ `_____ `_____ `______ `__________ `___ `__________ `___ `____ `__ `_ `____ `___ `_____________ `_______ `___ `__ `______ `___ `__ `________ `__ `___ ` `___ `_____ `______ `___ `____ `___ `_ `_____ `____ `__ `____ `___ `__ `___ `______________ `_ `_________ `___ `_____ `____ `__ `____ `_______ `___ `___ `__ `_______ `___ `_____ `___ `________ `__ `__ `__ `__ `_______ `_____ `___ `__ `___ `______ `_ `______ `_____ `______ `_ `_ `______ `________ `__ `_____ `________ `______ `_ `_ `__ `_______ `____ `_ `__ `___ `__ `__________ `_ `____ `___ `____ `____ `__ `____ `____ `__ `__ `________ `__________ `________ `______ ` `_____ `__ `___ `____ `__ `_____ `___ `____ `_ `____ `__ `___ `___ `_____________ `__ `_______ `____ `_ `__________ `__ `____________ `______ `___ `_____________ `_____ `_______ `__ `___ `___ `__ `_________ `________ `_ `__ `___ `________ `___ `_ `______ `__ `_____ 