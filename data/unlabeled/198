"Yesterday started like a relatively normal day at Coinbase, the largest U.S. exchange for buying and selling Bitcoin and other cryptocurrencies. The Bitcoin price was finally rising again, breaking above $10,000 for the first time in a month after a protracted crash.\n\nBut then the complaints started pouring in. Suddenly, Coinbase customers were being double-charged--and sometimes triple-charged, or even overcharged dozens of times over--for cryptocurrency purchases they'd made weeks earlier. Because the transactions were on credit and debit cards, the duplicate charges in some instances drained customers' bank accounts and then some, generating costly overdraft fees from their banks on top of it all.\n\nExecutives at San Francisco-based Coinbase were blindsided as the company's dedicated Reddit forum--a hotbed of customer angst--exploded with fury. One person claimed to be \"hit\" with 50 new charges of a total $67,000, forcing the user to close his bank account. Others complained that the duplicate charges had rendered them \"broke\" at the worst time: Their rent or electricity bills were due, and they had no money left to pay. Many accused Coinbase of fraud, or suggested it had been hacked.\n\nBy Thursday evening, though, Coinbase thought it had identified the culprit: , which Coinbase said had retroactively--and without any warning--reversed and resubmitted myriad Coinbase charges under a new payments code, as demanded by the big banks, earlier this year. The so-called merchant category code (or MCC) now in effect treats Visa purchases on Coinbase as cash advances, which come with high fees from banks of as much 10%. The switch coincided with several banks' decisions to ban credit card purchases of cryptocurrency, which may have triggered direct debits from customers' accounts instead.\n\n\"We immediately began an investigation, and through contacts with the card networks and the card issuers and our processor, determined that this was an action taken by Visa--it was not done by Coinbase,\" Dan Romero, vice president and general manager at Coinbase, told Fortune.\n\nMore than one million Coinbase transactions were reclassified and reprocessed on Visa's network, according to an industry source familiar with the situation. It appeared that the new Visa charges posted before banks were able to process refunds for the original transactions, resulting in overdrafts for many customers.\n\nBut the blame game is more complicated. Visa deflected fault for the incident, saying the problem was only affecting Coinbase customers. \"Visa has not made any systems changes that would result in the duplicate transactions that are being reported,\" a Visa spokesperson said. \"We are also not aware of any other merchants who are experiencing this issue.\" Rather, Visa laid blame with Coinbase's so-called acquiring bank, or processor, to whom it has reached out \"to offer assistance,\" the spokesperson added.\n\nIn this case, Coinbase's acquiring bank is Worldpay, one of the largest U.S. payment processors. A person close to Visa said it was only Worldpay, not Visa, that could have submitted transactions to the credit card company's network.\n\nBut Coinbase confirmed that only Visa cards experienced duplicate charges, and by Friday afternoon, Visa had begun processing refunds to erroneously charged Coinbase customers. Still, Visa stood by the classification under which the new charges were submitted, saying it had recently provided instructions to processors such as Worldpay clarifying the correct code to use for Coinbase transactions.\n\nOn Friday evening, Visa and Worldpay issued a joint statement posted on Coinbase's blog, saying, \"We deeply regret any inconvenience this may have caused customers.\" The mea culpa followed a meeting earlier in the day between Coinbase and representatives of both Visa and Worldpay to determine which company was most at fault for the debacle.\n\nAfter a Coinbase purchase I found a Cash Advance charge on a VISA RBC card I contacted VISA and they cancelled the charge. I told them that I would cancel all my RBC accounts immediately and that I requested that the employee report the loss of my business to his higher ups!\n\n-- Sher (@sherab_chodron) February 16, 2018\n\nHello, the recent change to the way Coinbase transactions are processed is due to a reclassification between the merchant and Visa. Any cash-like transaction, such as this, will be assessed the cash advance fee. This is typically $5 or 5% of the charge. ^RL\n\n-- Chase Support (@ChaseSupport) February 5, 2018\n\nStory Continues\n\nI contacted them but there was nothing they could do about a $10 charge.\n\nCitibank Visa!\n\n-- David Robinson (@23Dimensional23) February 16, 2018\n\nWorldpay, for its part, would neither confirm nor deny that the problem was tied to its own systems. \"We are actively working with and engaging all parties involved--including the card networks, issuing banks, other processors and Coinbase--to resolve this issue. We are all committed to helping resolve it for Coinbase's customers as quickly as possible.\"\n\nIn their statement Friday, Visa and Worldpay said they'd already reversed all duplicate transactions and expected customers to receive refunds within a few days.\n\nStill, one thing seems clear: The glitch would never have happened if the banks hadn't insisted on classifying Coinbase purchases as cash advances--despite the fact that the U.S. government does not currently consider cryptocurrencies currency at all.\n\n, some of whose cardholders experienced duplicate Coinbase transactions, declined to comment on the glitch, but referred Fortune to Visa for additional information. is also aware of the Coinbase issue and will refund any fees assessed as a result of the erroneous charges, but denies responsibility for the mistake, according to a person close to the bank.\n\nCoinbase has been moving in recent months to improve its customer service after admitting that it has struggled to keep pace with the demand for its cryptocurrency offerings. At the beginning of the year, the company poached Tina Bhatnagar from Twitter, hiring her as its vice president of technology and operations, a role that seeks to build out its customer support functions. It previously brought on board Asiff Hirji, a former top executive at Hewlett-Packard and TD Ameritrade, as its president and chief operating officer.\n\nThis article has been updated to reflect new developments in the story.\n\nSee original article on Fortune.com\n\nMore from Fortune.com\n\nMeet 'Paypal for Crypto,' a New Way to Pay With Bitcoin and LitecoinBlockchain Hires Google Vet in Bid to Take on CoinbaseBitcoin and Taxes: What You Need to Know About Cryptocurrency and the IRSCoinbase Expands Trading Options for Large InvestorsCoinbase Hires Twitter Executive Tina Bhatnagar to Improve Operations"